(function(){"use strict";var e={881:function(e,o,n){var t=n(751),r=n(641);const s={id:"app"};function a(e,o,n,t,a,i){const u=(0,r.g2)("Register"),l=(0,r.g2)("Login"),c=(0,r.g2)("BookPrice");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.bF)(u),(0,r.bF)(l,{onLoginSuccess:i.handleLoginSuccess},null,8,["onLoginSuccess"]),(0,r.bF)(c,{isLoggedIn:a.isLoggedIn},null,8,["isLoggedIn"])])}function i(e,o,n,s,a,i){return(0,r.uX)(),(0,r.CE)("div",null,[o[11]||(o[11]=(0,r.Lk)("h2",null,"注册",-1)),(0,r.Lk)("form",{onSubmit:o[4]||(o[4]=(0,t.D$)(((...e)=>i.register&&i.register(...e)),["prevent"]))},[o[6]||(o[6]=(0,r.Lk)("label",{for:"username"},"用户名:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>a.username=e),id:"username"},null,512),[[t.Jo,a.username]]),o[7]||(o[7]=(0,r.Lk)("label",{for:"password"},"密码:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password","onUpdate:modelValue":o[1]||(o[1]=e=>a.password=e),id:"password"},null,512),[[t.Jo,a.password]]),o[8]||(o[8]=(0,r.Lk)("label",{for:"age"},"年龄:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=e=>a.age=e),id:"age"},null,512),[[t.Jo,a.age]]),o[9]||(o[9]=(0,r.Lk)("label",{for:"gender"},"性别:",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>a.gender=e),id:"gender"},o[5]||(o[5]=[(0,r.Lk)("option",{value:"男"},"男",-1),(0,r.Lk)("option",{value:"女"},"女",-1)]),512),[[t.u1,a.gender]]),o[10]||(o[10]=(0,r.Lk)("button",{type:"submit"},"注册",-1))],32)])}var u=n(586),l={name:"UserRegister",data(){return{username:"",password:"",age:"",gender:"男"}},methods:{async register(){try{const e={username:this.username,password:this.password,age:this.age,gender:this.gender},o=await u.A.post("https://192.168.0.107:8888/user/register",e,{headers:{"Content-Type":"application/json"}});200===o.status&&alert("注册成功！")}catch(e){console.error("注册请求失败:",e)}}}},c=n(262);const p=(0,c.A)(l,[["render",i]]);var d=p;function g(e,o,n,s,a,i){return(0,r.uX)(),(0,r.CE)("div",null,[o[6]||(o[6]=(0,r.Lk)("h2",null,"登录",-1)),(0,r.Lk)("form",{onSubmit:o[2]||(o[2]=(0,t.D$)(((...e)=>i.login&&i.login(...e)),["prevent"]))},[o[3]||(o[3]=(0,r.Lk)("label",{for:"username"},"用户名:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>a.username=e),id:"username"},null,512),[[t.Jo,a.username]]),o[4]||(o[4]=(0,r.Lk)("label",{for:"password"},"密码:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password","onUpdate:modelValue":o[1]||(o[1]=e=>a.password=e),id:"password"},null,512),[[t.Jo,a.password]]),o[5]||(o[5]=(0,r.Lk)("button",{type:"submit"},"登录",-1))],32)])}var k={name:"UserLogin",data(){return{username:"",password:""}},methods:{async login(){try{const e={username:this.username,password:this.password,token:this.token},o=await u.A.post("https://192.168.0.107:8888/user/login",e,{headers:{"Content-Type":"application/json"}});200===o.status?(console.log("resp = ",o.data),console.log("login token = ",o.data.token),this.token=o.data.token,console.log("this token = ",this.token),localStorage.setItem("token",this.token),this.$emit("loginSuccess",this.username,this.token)):alert("登录失败，用户名或密码错误。")}catch(e){console.error("登录请求失败:",e),alert("登录请求失败，请检查服务器。")}}}};const h=(0,c.A)(k,[["render",g]]);var m=h,f=n(33);const b={key:0},L={key:0},v={key:1};function y(e,o,n,s,a,i){return n.isLoggedIn?((0,r.uX)(),(0,r.CE)("div",b,[o[4]||(o[4]=(0,r.Lk)("h2",null,"查询图书价格",-1)),(0,r.Lk)("form",{onSubmit:o[1]||(o[1]=(0,t.D$)(((...e)=>i.searchPrice&&i.searchPrice(...e)),["prevent"]))},[o[2]||(o[2]=(0,r.Lk)("label",{for:"bookName"},"图书名称:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>a.bookName=e),id:"bookName"},null,512),[[t.Jo,a.bookName]]),o[3]||(o[3]=(0,r.Lk)("button",{type:"submit"},"查询",-1))],32),null!==a.price?((0,r.uX)(),(0,r.CE)("div",L,[(0,r.Lk)("p",null,"图书价格: "+(0,f.v_)(a.price)+" 元",1)])):(0,r.Q3)("",!0)])):((0,r.uX)(),(0,r.CE)("div",v,o[5]||(o[5]=[(0,r.Lk)("p",null,"请先登录。",-1)])))}var w={name:"SearchBookPrice",props:["isLoggedIn","token"],data(){return{bookName:"",price:null}},methods:{async searchPrice(){const e=localStorage.getItem("token");try{const o=await u.A.get("https://192.168.0.107:8888/check",{params:{book:this.bookName},headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});200===o.status?this.price=o.data.price:this.price="未知"}catch(o){console.log("book = ",this.bookName),console.error("查询图书价格失败:",o)}}}};const C=(0,c.A)(w,[["render",y]]);var O=C,S={components:{Register:d,Login:m,BookPrice:O},data(){return{isLoggedIn:!1,token:""}},methods:{handleLoginSuccess(e,o){this.isLoggedIn=!0,this.token=o,console.log(e,"登录成功")}}};const j=(0,c.A)(S,[["render",a]]);var I=j;(0,t.Ef)(I).mount("#app")}},o={};function n(t){var r=o[t];if(void 0!==r)return r.exports;var s=o[t]={exports:{}};return e[t](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(o,t,r,s){if(!t){var a=1/0;for(c=0;c<e.length;c++){t=e[c][0],r=e[c][1],s=e[c][2];for(var i=!0,u=0;u<t.length;u++)(!1&s||a>=s)&&Object.keys(n.O).every((function(e){return n.O[e](t[u])}))?t.splice(u--,1):(i=!1,s<a&&(a=s));if(i){e.splice(c--,1);var l=r();void 0!==l&&(o=l)}}return o}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[t,r,s]}}(),function(){n.d=function(e,o){for(var t in o)n.o(o,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){var e={524:0};n.O.j=function(o){return 0===e[o]};var o=function(o,t){var r,s,a=t[0],i=t[1],u=t[2],l=0;if(a.some((function(o){return 0!==e[o]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(u)var c=u(n)}for(o&&o(t);l<a.length;l++)s=a[l],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},t=self["webpackChunkgreet"]=self["webpackChunkgreet"]||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))}();var t=n.O(void 0,[504],(function(){return n(881)}));t=n.O(t)})();
//# sourceMappingURL=app.d6e918eb.js.map